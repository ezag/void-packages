homepage=https://teams.microsoft.com/
license=MIT
maintainer="Eugen Zagorodniy <e.zagorodniy@gmail.com>"
pkgname=teams
revision=1
short_desc="Official Microsoft Teams client"
version=1.3.00.958

distfiles=https://packages.microsoft.com/repos/ms-${pkgname}/pool/main/t/${pkgname}/${pkgname}_${version}_amd64.deb
checksum=a50de47977e81f5ba924af5c7eb9e5a76b86e2c047762bc749924cbe5ee7aa04

repository=nonfree
skiprdeps="/opt/${pkgname}/libEGL.so"

do_extract() {
    ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/${pkgname}_${version}_amd64.deb
    bsdtar xf data.tar.xz
}

do_install() {
    vsed -i usr/bin/${pkgname} -e '/^USR_DIRECTORY=/d' -e 's!$USR_DIRECTORY/share!/opt!'
    vbin usr/bin/${pkgname}
    vmkdir opt
    vcopy usr/share/${pkgname} opt/
    vinstall usr/share/applications/${pkgname}.desktop 644 usr/share/applications
    vinstall usr/share/pixmaps/${pkgname}.png 644 usr/share/pixmaps
}
